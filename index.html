<!DOCTYPE html>
<html lang="nl">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>JSON Data Editor</title>
Â  Â  <style>
Â  Â  Â  Â  /* Standaardwaarden voor CSS variabelen */
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --week-columns: 4; /* Aantal weekkolommen (dynamisch ingesteld door JS) */
Â  Â  Â  Â  Â  Â  --graph-col-width: 50px; /* NIEUW: Vaste breedte voor de Graph toggle */
Â  Â  Â  Â  Â  Â  --total-columns: 7; /* Totaal aantal kolommen (Naam + Weeks + Graph + Acties) */
Â  Â  Â  Â  Â  Â  --name-col-width: 200px; /* Vaste breedte voor de variabele naam */
Â  Â  Â  Â  Â  Â  --action-col-width: 80px; /* Vaste breedte voor de acties knoppen */
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
Â  Â  Â  Â  Â  Â  background: #f5f5f5;
Â  Â  Â  Â  Â  Â  padding: 25px;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 1400px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  border-radius: 8px 8px 0 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header h1 {
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  font-size: 28px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .header p {
Â  Â  Â  Â  Â  Â  opacity: 0.9;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .controls {
Â  Â  Â  Â  Â  Â  padding: 20px 30px;
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid #e0e0e0;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-primary {
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-primary:hover {
Â  Â  Â  Â  Â  Â  background: #5568d3;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-success {
Â  Â  Â  Â  Â  Â  background: #48bb78;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-week-add {
Â  Â  Â  Â  Â  Â  background: #f6ad55;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-success:hover {
Â  Â  Â  Â  Â  Â  background: #38a169;
Â  Â  Â  Â  }

Â  Â  Â  Â  .file-input {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  .content {
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .category {
Â  Â  Â  Â  Â  Â  margin-bottom: 30px;
Â  Â  Â  Â  Â  Â  border: 1px solid #e0e0e0;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  .category-header {
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  padding: 12px 18px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  font-size: 20px;Â 
Â  Â  Â  Â  Â  Â  color: #2d3748;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .category-actions {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  .icon-btn {
Â  Â  Â  Â  Â  Â  width: 25px;Â 
Â  Â  Â  Â  Â  Â  height: 25px;Â 
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-size: 14px;Â 
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border: 1px solid #ddd;
Â  Â  Â  Â  }

Â  Â  Â  Â  .icon-btn:hover {
Â  Â  Â  Â  Â  Â  transform: scale(1.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-add {
Â  Â  Â  Â  Â  Â  color: #48bb78;
Â  Â  Â  Â  Â  Â  border-color: #48bb78;
Â  Â  Â  Â  }

Â  Â  Â  Â  .btn-delete {
Â  Â  Â  Â  Â  Â  color: #f56565;
Â  Â  Â  Â  Â  Â  border-color: #f56565;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- WEEK HEADER EN DATA GRID STYLES --- */

Â  Â  Â  Â  .week-header-row,
Â  Â  Â  Â  .variable-row {
Â  Â  Â  Â  Â  Â  /* NIEUWE GRID: Naam, Weeks, Graph, Acties */
Â  Â  Â  Â  Â  Â  grid-template-columns: var(--name-col-width) repeat(var(--week-columns), 1fr) var(--graph-col-width) var(--action-col-width);
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  gap: 5px;Â 
Â  Â  Â  Â  Â  Â  align-items: stretch;Â 
Â  Â  Â  Â  Â  Â  padding: 0;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .week-header-row {
Â  Â  Â  Â  Â  Â  background: #e9ecef;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  padding: 10px 0;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  color: #667eea;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Cellen krijgen nu de verticale padding */
Â  Â  Â  Â  .name-cell, .input-with-delta, .action-cell, .week-header-cell, .graph-cell {
Â  Â  Â  Â  Â  Â  padding-top: 8px;
Â  Â  Â  Â  Â  Â  padding-bottom: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .week-header-cell, .graph-header-cell {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  font-size: 14px; /* Iets kleiner voor 'Graph' */
Â  Â  Â  Â  }

Â  Â  Â  Â  .week-header-row .name-cell {
Â  Â  Â  Â  Â  Â  padding-left: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .week-header-row .action-cell {
Â  Â  Â  Â  Â  Â  text-align: center;Â 
Â  Â  Â  Â  Â  Â  padding-right: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .variable-row {
Â  Â  Â  Â  Â  Â  border-bottom: 1px solid #f0f0f0;
Â  Â  Â  Â  }

Â  Â  Â  Â  .main-variable-row {
Â  Â  Â  Â  Â  Â  background: #fcfcfc;
Â  Â  Â  Â  Â  Â  border-left: 3px solid #667eea;
Â  Â  Â  Â  Â  Â  margin-bottom: 0;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* OPLOSSING: Margin-left verwijderd om de kolommen uit te lijnen */
Â  Â  Â  Â  .sub-variable-row {
Â  Â  Â  Â  Â  Â  background: #ffffff;
Â  Â  Â  Â  Â  Â  border-left: 1px solid #ddd;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Naam Cell (Kolom 1) */
Â  Â  Â  Â  .name-cell {
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  padding-left: 10px; /* Base padding */
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  text-overflow: ellipsis;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 15px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* OPLOSSING: Padding verhoogd om de visuele indent te creÃ«ren binnen de uitgelijnde kolom */
Â  Â  Â  Â  .sub-variable-row .name-cell {
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  color: #4a5568;
Â  Â  Â  Â  Â  Â  padding-left: 30px; /* Dit creÃ«ert de indent */
Â  Â  Â  Â  Â  Â  font-size: 14px;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .name-cell:focus {
Â  Â  Â  Â  Â  Â  outline: 1px dashed #667eea;
Â  Â  Â  Â  }


Â  Â  Â  Â  /* Data Input Cell Styles */
Â  Â  Â  Â  .input-with-delta {
Â  Â  Â  Â  Â  Â  /* Horizontale opmaak voor input en delta */
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: row;Â 
Â  Â  Â  Â  Â  Â  gap: 3px;Â 
Â  Â  Â  Â  Â  Â  align-items: center;Â 
Â  Â  Â  Â  Â  Â  justify-content: center; /* Centreert de input + delta groep in de kolom */
Â  Â  Â  Â  }

Â  Â  Â  Â  .data-input {
Â  Â  Â  Â  Â  Â  padding: 3px 5px;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid #cbd5e0;
Â  Â  Â  Â  Â  Â  border-radius: 3px;
Â  Â  Â  Â  Â  Â  font-size: 15px;Â 
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  max-width: 50px;Â 
Â  Â  Â  Â  Â  Â  min-height: 25px;Â 
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  transition: all 0.1s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .delta-indicator {
Â  Â  Â  Â  Â  Â  font-size: 13px;Â 
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  line-height: 1;
Â  Â  Â  Â  Â  Â  white-space: nowrap;Â 
Â  Â  Â  Â  Â  Â  min-width: 40px;Â 
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  }

Â  Â  Â  Â  .delta-up { color: #48bb78; }
Â  Â  Â  Â  .delta-down { color: #f56565; }
Â  Â  Â  Â  .delta-none { color: #718096; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* NIEUW: Graph Cell Stijl */
Â  Â  Â  Â  .graph-cell {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Actie Knoppen Cell (Laatste Kolom) */
Â  Â  Â  Â  .action-cell {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 3px;
Â  Â  Â  Â  Â  Â  justify-content: center;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .variable-row .action-cell {
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Notitieveld Stijl --- */
Â  Â  Â  Â  .variable-notes {
Â  Â  Â  Â  Â  Â  grid-column: 1 / span var(--total-columns);Â 
Â  Â  Â  Â  Â  Â  padding: 5px 10px 10px 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  Â  Â  Â  border-left: 3px solid #667eea;Â 
Â  Â  Â  Â  Â  Â  background: #fcfcfc;
Â  Â  Â  Â  }
Â  Â  Â  Â  .notes-input {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 8px;Â 
Â  Â  Â  Â  Â  Â  border: 1px solid #cbd5e0;
Â  Â  Â  Â  Â  Â  border-radius: 4px;
Â  Â  Â  Â  Â  Â  font-size: 14px;Â 
Â  Â  Â  Â  Â  Â  resize: vertical;
Â  Â  Â  Â  Â  Â  min-height: 60px;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Media Queries --- */
Â  Â  Â  Â  @media (max-width: 992px) {
Â  Â  Â  Â  Â  Â  /* Moet de grid-template-columns hier aanpassen als je mobiele weergave wilt behouden */
Â  Â  Â  Â  Â  Â  /* Aangezien de oorspronkelijke code dit naar 1fr zette, behouden we dat */
Â  Â  Â  Â  Â  Â  .week-header-row,
Â  Â  Â  Â  Â  Â  .variable-row {
Â  Â  Â  Â  Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .variable-notes {
Â  Â  Â  Â  Â  Â  Â  Â  grid-column: 1;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  .input-with-delta {
Â  Â  Â  Â  Â  Â  Â  Â  flex-direction: row;Â 
Â  Â  Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  Â  Â  padding-left: 10px;
Â  Â  Â  Â  Â  Â  Â  Â  padding-right: 10px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  .data-input {
Â  Â  Â  Â  Â  Â  Â  Â  max-width: 100px;Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  /* Verberg de graph en acties cellen op mobiel (dit is een aanname) */
Â  Â  Â  Â  Â  Â  .graph-cell, .action-cell {
Â  Â  Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="header">
Â  Â  Â  Â  Â  Â  <h1>ðŸ“Š JSON Data Editor</h1>
Â  Â  Â  Â  Â  Â  <p>Laad, bekijk en bewerk je data eenvoudig</p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  Â  <input type="file" id="fileInput" accept="application/json" class="file-input">
Â  Â  Â  Â  Â  Â  <button class="btn btn-primary" onclick="document.getElementById('fileInput').click()">JSON Bestand Laden</button>
Â  Â  Â  Â  Â  Â  <button class="btn btn-success" onclick="saveJSON()">Opslaan (updated_data.json)</button>
Â  Â  Â  Â  Â  Â  <button class="btn btn-week-add" onclick="addWeek()">Week Toevoegen</button>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="content" id="content">
Â  Â  Â  Â  Â  Â  <div class="empty-state">
Â  Â  Â  Â  Â  Â  Â  Â  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  <h3>Geen bestand geladen</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p>Klik op "JSON Bestand Laden" om te beginnen</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  let jsonData = null;
Â  Â  Â  Â  let weeks = [];Â 

Â  Â  Â  Â  document.getElementById('fileInput').addEventListener('change', function(e) {
Â  Â  Â  Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  Â  Â  Â  if (file) {
Â  Â  Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  Â  Â  reader.onload = function(event) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jsonData = JSON.parse(event.target.result);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Zorg ervoor dat alle variabelen een 'graph' eigenschap hebben na het laden
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Object.keys(jsonData).forEach(categoryKey => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables.forEach(variable => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (variable.graph === undefined) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.graph = false; // Standaardwaarde
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Fout bij het laden van JSON: ' + error.message);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  reader.readAsText(file);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  function updateGraphToggle(categoryKey, varIndex, subIndex = null, isChecked) {
Â  Â  Â  Â  Â  Â  if (!jsonData) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (subIndex !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  // Subvariabelen hebben geen 'graph' eigenschap volgens de JSON-structuur,
Â  Â  Â  Â  Â  Â  Â  Â  // maar we kunnen deze toevoegen indien gewenst. Ik voer het hier uit voor subvariabelen
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables[subIndex].graph = isChecked;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].graph = isChecked;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // Huidige data hoeft niet opnieuw gerenderd te worden voor een simpele toggle
Â  Â  Â  Â  Â  Â  console.log(`Graph toggle for ${categoryKey}/${varIndex}/${subIndex} set to: ${isChecked}`);
Â  Â  Â  Â  }

Â  Â  Â  Â  function addWeek() {
Â  Â  Â  Â  Â  Â  if (!jsonData || Object.keys(jsonData).length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Laad eerst een JSON-bestand.');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const maxWeekNumber = weeks.length;
Â  Â  Â  Â  Â  Â  const newWeekName = `Week ${maxWeekNumber + 1}`;

Â  Â  Â  Â  Â  Â  Object.keys(jsonData).forEach(categoryKey => {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables.forEach(variable => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.data[newWeekName] = null;Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (variable.subVariables) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.subVariables.forEach(subVar => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subVar.data[newWeekName] = null;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  }


Â  Â  Â  Â  function updateName(categoryKey, varIndex, subIndex = null, newName) {
Â  Â  Â  Â  Â  Â  if (!jsonData || !newName) return;

Â  Â  Â  Â  Â  Â  if (subIndex !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables[subIndex].name = newName;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].name = newName;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  function calculateDelta(currentValue, previousValue) {
Â  Â  Â  Â  Â  Â  if (currentValue === null || previousValue === null || previousValue === undefined) {
Â  Â  Â  Â  Â  Â  Â  Â  return { html: '', className: 'delta-none' };
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const delta = currentValue - previousValue;
Â  Â  Â  Â  Â  Â  // Rond af op hele getallen voor de delta
Â  Â  Â  Â  Â  Â  const roundedDelta = Math.round(delta);Â 

Â  Â  Â  Â  Â  Â  // Gebruik de gewenste opmaak met â–² en â–¼
Â  Â  Â  Â  Â  Â  const deltaDisplay = roundedDelta !== 0Â 
Â  Â  Â  Â  Â  Â  Â  Â  ? (roundedDelta > 0 ? `â–² +${Math.abs(roundedDelta)}` : `â–¼ ${roundedDelta}`)Â 
Â  Â  Â  Â  Â  Â  Â  Â  : 'â€” 0';Â 

Â  Â  Â  Â  Â  Â  const className = roundedDelta > 0 ? 'delta-up' : (roundedDelta < 0 ? 'delta-down' : 'delta-none');

Â  Â  Â  Â  Â  Â  return { html: deltaDisplay, className: className };
Â  Â  Â  Â  }

Â  Â  Â  Â  function renderData() {
Â  Â  Â  Â  Â  Â  const content = document.getElementById('content');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Bepaal de weken dynamisch en sorteer ze
Â  Â  Â  Â  Â  Â  weeks = [];
Â  Â  Â  Â  Â  Â  if (jsonData) {
Â  Â  Â  Â  Â  Â  Â  Â  Â Object.keys(jsonData).forEach(categoryKey => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â jsonData[categoryKey].variables.forEach(variable => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â // Check of 'graph' bestaat, anders toevoegen
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (variable.graph === undefined) variable.graph = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â if (Object.keys(variable.data).length > weeks.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â weeks = Object.keys(variable.data).sort((a, b) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const numA = parseInt(a.replace('Week ', ''));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const numB = parseInt(b.replace('Week ', ''));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return numA - numB;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  Â  Â  Â });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  content.innerHTML = '';

Â  Â  Â  Â  Â  Â  if (!jsonData || Object.keys(jsonData).length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  content.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="empty-state">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </svg>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>Geen bestand geladen</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Klik op "JSON Bestand Laden" om te beginnen</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Pas de CSS Grid aan via JavaScript om het aantal kolommen te matchen
Â  Â  Â  Â  Â  Â  const columns = weeks.length;
Â  Â  Â  Â  Â  Â  document.documentElement.style.setProperty('--week-columns', columns);
Â  Â  Â  Â  Â  Â  document.documentElement.style.setProperty('--total-columns', columns + 3); // Naam + Weeks + Graph + Acties


Â  Â  Â  Â  Â  Â  Object.keys(jsonData).forEach(categoryKey => {
Â  Â  Â  Â  Â  Â  Â  Â  const category = jsonData[categoryKey];
Â  Â  Â  Â  Â  Â  Â  Â  const categoryDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  categoryDiv.className = 'category';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  const contentDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  contentDiv.className = 'category-content';

Â  Â  Â  Â  Â  Â  Â  Â  // 1. CATEGORY HEADER
Â  Â  Â  Â  Â  Â  Â  Â  const headerDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  headerDiv.className = 'category-header';
Â  Â  Â  Â  Â  Â  Â  Â  headerDiv.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span>${categoryKey}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="category-actions">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn btn-add" onclick="event.stopPropagation(); addVariable('${categoryKey}')" title="Variabele toevoegen">+</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  categoryDiv.appendChild(headerDiv);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // 2. WEEK HEADER ROW
Â  Â  Â  Â  Â  Â  Â  Â  const weekHeaderRow = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  weekHeaderRow.className = 'week-header-row';
Â  Â  Â  Â  Â  Â  Â  Â  // Eerste kolom (naam)
Â  Â  Â  Â  Â  Â  Â  Â  weekHeaderRow.innerHTML = `<div class="name-cell">Variabele/Subvariabele</div>`;Â 
Â  Â  Â  Â  Â  Â  Â  Â  weeks.forEach(week => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  weekHeaderRow.innerHTML += `<div class="week-header-cell">${week}</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  // NIEUW: Graph kolom
Â  Â  Â  Â  Â  Â  Â  Â  weekHeaderRow.innerHTML += `<div class="week-header-cell graph-header-cell">ðŸ“ˆ</div>`;
Â  Â  Â  Â  Â  Â  Â  Â  // Laatste kolom 'Acties'
Â  Â  Â  Â  Â  Â  Â  Â  weekHeaderRow.innerHTML += `<div class="action-cell">Acties</div>`;Â 
Â  Â  Â  Â  Â  Â  Â  Â  contentDiv.appendChild(weekHeaderRow);


Â  Â  Â  Â  Â  Â  Â  Â  category.variables.forEach((variable, varIndex) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (variable.notes === undefined) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.notes = "";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Zorg ervoor dat 'graph' bestaat
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (variable.graph === undefined) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.graph = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 3. HOOFD VARIABELE RIJ
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const varDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  varDiv.className = 'variable-row main-variable-row';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Naam Cell (Kolom 1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const nameCell = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nameCell.className = 'name-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nameCell.setAttribute('contenteditable', 'true');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nameCell.onblur = function() { updateName(categoryKey, varIndex, null, this.textContent); };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  nameCell.textContent = variable.name;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  varDiv.appendChild(nameCell);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Data Inputs (Kolommen 2 tot N+1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  weeks.forEach((week, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const inputContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.className = 'input-with-delta';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const input = document.createElement('input');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.type = 'text';Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.className = 'data-input';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.placeholder = '0';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.value = variable.data[week] !== null ? variable.data[week] : '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const deltaDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Delta indicator
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (i > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const previousWeek = weeks[i - 1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const delta = calculateDelta(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.data[week],Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.data[previousWeek]
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.className = `delta-indicator ${delta.className}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.innerHTML = delta.html;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Week 1 heeft geen delta
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.className = 'delta-indicator delta-none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.innerHTML = '';Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.onchange = function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const value = this.value === '' ? null : parseFloat(this.value);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].data[week] = value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.appendChild(input);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.appendChild(deltaDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  varDiv.appendChild(inputContainer);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // NIEUW: Graph Cell (Tussen Weeks en Acties)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const graphDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graphDiv.className = 'graph-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const graphCheckbox = document.createElement('input');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graphCheckbox.type = 'checkbox';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graphCheckbox.checked = variable.graph;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graphCheckbox.onchange = function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGraphToggle(categoryKey, varIndex, null, this.checked);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  graphDiv.appendChild(graphCheckbox);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  varDiv.appendChild(graphDiv);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Actie Knoppen (Laatste Kolom)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const actionsDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  actionsDiv.className = 'variable-actions action-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  actionsDiv.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn btn-add" onclick="addSubVariable('${categoryKey}', ${varIndex})" title="Subvariabele toevoegen">+</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn btn-delete" onclick="deleteVariable('${categoryKey}', ${varIndex})" title="Variabele verwijderen">Ã—</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  varDiv.appendChild(actionsDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contentDiv.appendChild(varDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 4. SUBVARIABLE RIJEN
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (variable.subVariables && variable.subVariables.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  variable.subVariables.forEach((subVar, subIndex) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Zorg ervoor dat 'graph' bestaat op subvariabelen
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (subVar.graph === undefined) subVar.graph = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subDiv.className = 'variable-row sub-variable-row';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Naam Cell (Kolom 1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subNameCell = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subNameCell.className = 'name-cell sub-name-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subNameCell.setAttribute('contenteditable', 'true');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subNameCell.textContent = subVar.name;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subNameCell.onblur = function() { updateName(categoryKey, varIndex, subIndex, this.textContent); };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subDiv.appendChild(subNameCell);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Data Inputs (Kolommen 2 tot N+1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  weeks.forEach((week, i) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const inputContainer = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.className = 'input-with-delta';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const input = document.createElement('input');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.type = 'text';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.className = 'data-input';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.placeholder = '0';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.value = subVar.data[week] !== null ? subVar.data[week] : '';

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const deltaDiv = document.createElement('div');

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (i > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const previousWeek = weeks[i - 1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const delta = calculateDelta(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subVar.data[week],Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subVar.data[previousWeek]
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.className = `delta-indicator ${delta.className}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.innerHTML = delta.html;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.className = 'delta-indicator delta-none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deltaDiv.innerHTML = '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  input.onchange = function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const value = this.value === '' ? null : parseFloat(this.value);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables[subIndex].data[week] = value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderData();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.appendChild(input);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  inputContainer.appendChild(deltaDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subDiv.appendChild(inputContainer);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // NIEUW: Graph Cell voor subvariabelen
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subGraphDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subGraphDiv.className = 'graph-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subGraphCheckbox = document.createElement('input');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subGraphCheckbox.type = 'checkbox';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subGraphCheckbox.checked = subVar.graph || false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subGraphCheckbox.onchange = function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateGraphToggle(categoryKey, varIndex, subIndex, this.checked);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subGraphDiv.appendChild(subGraphCheckbox);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subDiv.appendChild(subGraphDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Actie Knoppen (Laatste Kolom)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const subActionsDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subActionsDiv.className = 'variable-actions action-cell';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subActionsDiv.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="icon-btn btn-delete" onclick="deleteSubVariable('${categoryKey}', ${varIndex}, ${subIndex})" title="Subvariabele verwijderen">Ã—</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  subDiv.appendChild(subActionsDiv);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contentDiv.appendChild(subDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // 5. NOTITIEVELD
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const notesDiv = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesDiv.className = 'variable-notes';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const notesInput = document.createElement('textarea');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesInput.className = 'notes-input';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesInput.placeholder = 'Voeg hier een notitie toe...';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesInput.value = variable.notes || '';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesInput.onchange = function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].notes = this.value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  renderData();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  notesDiv.appendChild(notesInput);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  contentDiv.appendChild(notesDiv);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  categoryDiv.appendChild(contentDiv);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('content').appendChild(categoryDiv);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveJSON() {
Â  Â  Â  Â  Â  Â  if (!jsonData) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Geen data om op te slaan');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const dataStr = JSON.stringify(jsonData, null, 2);
Â  Â  Â  Â  Â  Â  const blob = new Blob([dataStr], { type: 'application/json' });
Â  Â  Â  Â  Â  Â  const url = URL.createObjectURL(blob);
Â  Â  Â  Â  Â  Â  const a = document.createElement('a');
Â  Â  Â  Â  Â  Â  a.href = url;
Â  Â  Â  Â  Â  Â  a.download = 'updated_data.json';
Â  Â  Â  Â  Â  Â  document.body.appendChild(a);
Â  Â  Â  Â  Â  Â  a.click();
Â  Â  Â  Â  Â  Â  document.body.removeChild(a);
Â  Â  Â  Â  Â  Â  URL.revokeObjectURL(url);
Â  Â  Â  Â  }

Â  Â  Â  Â  function addVariable(categoryKey) {
Â  Â  Â  Â  Â  Â  if (!jsonData) return;

Â  Â  Â  Â  Â  Â  const name = prompt('Naam van de nieuwe variabele:');
Â  Â  Â  Â  Â  Â  if (!name) return;

Â  Â  Â  Â  Â  Â  const newVariable = {
Â  Â  Â  Â  Â  Â  Â  Â  name: name,
Â  Â  Â  Â  Â  Â  Â  Â  unit: "",
Â  Â  Â  Â  Â  Â  Â  Â  data: weeks.reduce((acc, weekName) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  acc[weekName] = null;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  Â  Â  Â  Â  }, {}),Â 
Â  Â  Â  Â  Â  Â  Â  Â  subVariables: [],
Â  Â  Â  Â  Â  Â  Â  Â  notes: "",
Â  Â  Â  Â  Â  Â  Â  Â  graph: false // NIEUW: Standaardwaarde voor graph toggle
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables.push(newVariable);
Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteVariable(categoryKey, varIndex) {
Â  Â  Â  Â  Â  Â  if (!jsonData) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const variable = jsonData[categoryKey].variables[varIndex];
Â  Â  Â  Â  Â  Â  if (confirm(`Weet je zeker dat je "${variable.name}" wilt verwijderen?`)) {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables.splice(varIndex, 1);
Â  Â  Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function addSubVariable(categoryKey, varIndex) {
Â  Â  Â  Â  Â  Â  if (!jsonData) return;

Â  Â  Â  Â  Â  Â  const name = prompt('Naam van de nieuwe subvariabele:');
Â  Â  Â  Â  Â  Â  if (!name) return;

Â  Â  Â  Â  Â  Â  const newSubVariable = {
Â  Â  Â  Â  Â  Â  Â  Â  data: weeks.reduce((acc, weekName) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  acc[weekName] = null;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return acc;
Â  Â  Â  Â  Â  Â  Â  Â  }, {}),
Â  Â  Â  Â  Â  Â  Â  Â  name: name,
Â  Â  Â  Â  Â  Â  Â  Â  graph: false // NIEUW: Standaardwaarde voor graph toggle
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  // Zorg ervoor dat subVariables bestaat
Â  Â  Â  Â  Â  Â  if (!jsonData[categoryKey].variables[varIndex].subVariables) {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables = [];
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables.push(newSubVariable);
Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  function deleteSubVariable(categoryKey, varIndex, subIndex) {
Â  Â  Â  Â  Â  Â  if (!jsonData) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const subVar = jsonData[categoryKey].variables[varIndex].subVariables[subIndex];
Â  Â  Â  Â  Â  Â  if (confirm(`Weet je zeker dat je "${subVar.name}" wilt verwijderen?`)) {
Â  Â  Â  Â  Â  Â  Â  Â  jsonData[categoryKey].variables[varIndex].subVariables.splice(subIndex, 1);
Â  Â  Â  Â  Â  Â  Â  Â  renderData();Â 
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
